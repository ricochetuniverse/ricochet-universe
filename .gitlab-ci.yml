image: php:7.2.10-fpm-alpine3.8

#services:
#- mysql:latest

cache:
    paths:
        - vendor/
        - node_modules/

before_script:
    - apt-get update

    - curl -L https://deb.nodesource.com/setup_8.x | bash -

    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list

    - apt-get install -y git nodejs yarn

    # - cp .env.testing .env

    - curl https://getcomposer.org/installer | php
    - php composer.phar install

    - yarn

phpunit:
    stage: test
    script:
        - php ./vendor/bin/phpunit --coverage-text --colors=never

prettier:
    stage: test
    script:
        - yarn run prettier -l
